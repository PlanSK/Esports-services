{% load bootstrap_icons %}
{% load salary_tags %}
{% load humanize %}
<div class="row">
    <div class="col-md-12 border">
      <table class="table table-dark table-hover">
        <thead class="text-warning text-center verysmall">
          <tr>
            {% table_header user as cols %}
            {% for col in cols %}
            <th scope="col">{{ col }}</th>
            {% endfor %}
          </tr>
        </thead>
        <tbody class="text-center verysmall">

          {% for table in tables %}
          <tr>
            <td>{% date_format table.shift_date %}</td>
            <td>{{ table.bar_revenue | intcomma }}</td>
            <td>{{ table.game_zone_revenue | intcomma }}</td>
            <td>{{ table.vr_revenue | intcomma }}</td>
            <td>{{ table.summary_revenue | intcomma }}</td>
            
            {% if  user.profile.position.name == 'hall_admin' %}
            <td>
              {% if table.hall_admin_discipline %}
                {% bs_icon 'check-circle' color='green' %}
              {% else %}
                {% bs_icon 'x-circle' color='red' %}
              {% endif %}
            </td>
            <td>
              {% if table.hall_cleaning %}
                {% bs_icon 'check-circle' color='green' %}
              {% else %}
                {% bs_icon 'x-circle' color='red' %}
              {% endif %}
            </td>

            {% elif  user.profile.position.name == 'cash_admin' %}
            <td>{{ table.hall_admin.first_name }} {{ table.hall_admin.last_name }}</td>
            <td>
              {% if table.cash_admin_discipline %}
                {% bs_icon 'check-circle' color='green' %}
              {% else %}
                {% bs_icon 'x-circle' color='red' %}
              {% endif %}
            </td>
              {% if table.shortage %}
                <td class="text-danger">{{table.shortage}}</td>
              {% else %}
                <td>-</td>
              {% endif %}
            {% endif %}
            <td>
              {% if table.is_verified %}
                {{ table.kpi_salary | intcomma }}
              {% else %}
              <span title='Расчитывается после проверки'>{% bs_icon 'lock' color='gray' %}</span>
              {% endif %}
            </td>

            <td>
              {% if table.is_verified %}
                <span title="Проверено">{% bs_icon 'check2-circle' color='green' %}</span>
              {% elif user.profile.position.name == 'cash_admin' %}
              <a title="Внести изменения" href="{% url 'edit_workshift' table.pk %}">
                {% bs_icon 'pencil-square' color='yellow' %}
              </a>
              {% else %}
              <span title='Ожидает проверки'>{% bs_icon 'stopwatch' color='yellow'%}</span>
              {% endif %}
            </td>
          </tr>
          {% endfor %}
        </tbody>
        <tfoot class="text-center verysmall text-white">
          <tr>
            <td scope="col">Итог за месяц:</td>
            <td scope="col">{{ total_values.bar | intcomma }}</td>
            <td scope="col">{{ total_values.game_zone | intcomma }}</td>
            <td scope="col">{{ total_values.vr | intcomma }}</td>
            <td scope="col">{{ total_values.sum_revenue | intcomma }}</td>
            {% if  user.profile.position.name == 'hall_admin' %}
            <td>{{ total_values.total_discipline }}%</td>
            <td>{{ total_values.total_cleaning }}%</td>
            {% elif  user.profile.position.name == 'cash_admin' %}
            <td scope="col"></td>
            <td>{{ total_values.total_discipline }}%</td>
            <td></td>
            {% endif %}
            <td scope="col">{{ total_values.total_salary | intcomma }}</td>
            <td></td>
          </tr>
        </tfoot>
      </table>
    </div>
  </div>