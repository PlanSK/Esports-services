{% extends 'salary/logined_page.html' %}
{% load humanize %}

{% block content %}
<div class="container">
  <div class="col table-responsive border rounded m-3 text-center">
    {{ intruder.get_full_name }}<hr>
    <table class="table table-dark">
      {% if object_list %}
      <thead class="text-warning text-center verysmall">
        <tr>
          <th>Дата</th>
          <th>Нарушение</th>
          <th>Статус</th>
          <th>Санкция</th>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tbody class="text-center verysmall">
        {% for misconduct in object_list %} 
        <tr>
          <td>{{ misconduct.misconduct_date|date:"d.m.Y" }}</td>
          <td>{{ misconduct.regulations_article.title|truncatewords:2 }}</td>
          <td>
            {% if misconduct.status == 'AD' %}
            <i class="fa-solid fa-file-circle-question fa-fade fa-xl" style="color: coral;"></i><br>Ожидает объяснение
            {% elif misconduct.status == 'WT' %}
            <i class="fa-regular fa-clock fa-fade fa-xl" style="color: yellow;"></i><br>На рассмотрении
            {% elif misconduct.status == 'CL' %}
            <i class="fa-solid fa-clipboard-check fa-xl" style="color: yellowgreen;"></i><br>Решение принято
            {% endif %}
          </td>
          <td>{{ misconduct.penalty|default:"Предупреждение" | intcomma }}</td>
          <td><a href="{{ misconduct.get_absolute_url }}" class="link-primary">Смотреть</a></td>
          {% if perms.salary.change_misconduct and perms.salary.delete_misconduct %}
          <td>
            <a href="{% url 'edit_misconduct' pk=misconduct.pk %}?next={{ request.path }}" class="btn btn-warning verysmall">
              <i class="bi bi-pen"></i>
            </a>
            <a href="{% url 'delete_misconduct' pk=misconduct.pk %}?next={{ request.path }}" class="btn btn-danger verysmall">
              <i class="bi bi-x"></i>
            </a>
          </td>
          {% else %}
          <td></td>
          {% endif %}
        </tr>
        {% endfor %}
      </tbody>
      <tfoot class="verysmall">
        <tr>
          <td></td>
          <td>{{ object_list.count }}</td>
          <td></td>
          <td>{{ penalty_sum }}</td>
          <td colspan="2"></td>
        </tr>
      </tfoot>
      {% else %}
      <tr>
        <td colspan="4" class="verysmall text-warning">Нарушений нет</td>
      </tr>
      {% endif %}
    </table>
  </div>
  <div class="row">
    <div class="col text-center">
      <a class="btn btn-outline-secondary verysmall" href="{{ request.GET.next | default:'/' }}">Назад</a>
    </div>
  </div>
</div>
{% endblock %}